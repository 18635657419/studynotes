## 联合体（union）

个数据需要共享内存或者多个数据每次只取其一时，可以利用联合体(union)。在C Programming Language 一书中对于联合体是这么描述的：

    1)联合体是一个结构；

    2)它的所有成员相对于基地址的偏移量都为0；

    3)此结构空间要大到足够容纳最"宽"的成员；

    4)其对齐方式要适合其中所有的成员；

下面解释这四条描述：

由于联合体中的所有成员是共享一段内存的，因此每个成员的存放首地址相对于于联合体变量的基地址的偏移量为0，即所有成员的首地址都是一样的。为了使得所有成员能够共享一段内存，因此该空间必须足够容纳这些成员中最宽的成员。对于这句“对齐方式要适合其中所有的成员”是指其必须符合所有成员的自身对齐方式

定义一个联合体

```
union U
{
    char s[9];
    int n;
    double d;
} u1;

sizeof(u1) // 16
```
联合体的大小。必须满足两个条件：1)大小足够容纳最宽的成员；2)大小能被其包含的所有基本数据类型的大小所整除。

```
union U1
{
    char s[9];
    int n;
    double d;
} u1;
u1.n = 10;
int a = checkCPU();
int *p1 = (int *) &u1;
printf("%d\n",*p1); /*10*/
u1.s[0] ='h';
u1.s[1] = 'w';
u1.s[3] ='\0';
char *p2 = (char *)&u1;
printf("%c\n",*p2);/*h*/
printf("%d\n",a);
    
```


共用体”，在某种程度上类似结构体struct的一种数据结构，共用体(union)和结构体(struct)同样可以包含很多种数据类型和变量。
不过区别也挺明显：
结构体(struct)中所有变量是“共存”的——优点是“有容乃大”，全面；缺点是struct内存空间的分配是粗放的，不管用不用，全分配。
而联合体(union)中是各变量是“互斥”的——缺点就是不够“包容”；但优点是内存使用更为精细灵活，也节省了内存空间