## 临界区

- **屏蔽硬件终端**

没有终端，没有上下文切换，因此没有并发。

 进入临界区，禁止中断。

离开临界区，开启中断

- **基于软件的抽象**

```
do {
  进入
  离开
  提醒
}
```

使用两个共享数据项

int turn 指示进入临界区

bolean flag[]  指示进程是否准备好进入临界区

进入临界区操作

flag[i] = true

turn = j;

while(flag[j] && turn == j)

退出临界区

flag[i] = false;

- **更高级的抽象**  原子操作指令

硬件提供了一些原语

1. 像中断禁用，原子操作指令

操作系统提供更高级的抽象

1. 锁、信号等

锁是一个抽象的数据结构

1. 一个二进制的状态 锁定和解锁

test-and-set 测试和置位

- 从内存读取值
- 测试值是否为1
- 内存值设置为1

