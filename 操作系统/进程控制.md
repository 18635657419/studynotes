## 进程控制

停止当前的运行进程，并且调度其他进程。

- 必须在切换之前存储部分进程的上下文
- 必须能够在之后恢复他们。
- 必须迅速切换

上下文：程序运行需要的资源的集合

存储上下文

寄存器、cpu状态

操作系统为活跃继承准备进程控制块，将进程控制块放置一个合适的队列。

就绪队列、等待队列、僵尸队列。

exec 加载一个不同的程序， 并执行新的程序。

如果调用成功，代码段、堆栈被覆盖



fork的开销

- 对子进程分配内存
- 复制父进程的内存和cpu寄存器到子进程
- 开销大

在99%的清空下，我们调用fork之后，直接调用exec

- 在fork 操作内存复制是没有用的
- 子进程将关闭打开的文件
- 开销高

vfork

- 一个创建进程的系统调用，不需要创建一个同样的内存映像
- 子进程应该不立即调用exec
- cow



wait 系统调用，是被父进程来等待子进程的结束，

- 一个子进程向父进程返回一个值，

wait系统调用担任的角色

- 它使父进程去睡眠等待子进程的结果
- 当一个子进程调用exit，操作系统解锁父进程，
- 如果有父进程的僵尸等待，wait立即返回其中一个值、
- 释放内存
- 关闭所有打开的文件
- 检查父进程是存存活。

进程结束执行之后，调用exit()

